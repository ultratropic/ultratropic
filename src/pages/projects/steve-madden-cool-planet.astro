---
import BaseLayout from '../../layouts/BaseLayout.astro';
---
<BaseLayout title="Steve Madden Cool Planet | Ultratropic">
  <div class="project-container">
    <video
      autoplay
      muted
      loop
      playsinline
      preload="auto"
      class="landscape-video"
    >
      <source src="/projects/steve_madden-cool_planet/sm-cp-landscape.mp4" type="video/mp4" />
    </video>
    <video
      autoplay
      muted
      loop
      playsinline
      preload="auto"
      class="portrait-video"
    >
      <source src="/projects/steve_madden-cool_planet/sm-cp-portrait.mp4" type="video/mp4" />
    </video>
  </div>

  <script>
    // Handle orientation-based video switching
    document.addEventListener('DOMContentLoaded', () => {
      const landscapeVideo = document.querySelector('.landscape-video');
      const portraitVideo = document.querySelector('.portrait-video');
      const isPortrait = window.matchMedia('(orientation: portrait)').matches;

      const activeVideo = isPortrait ? portraitVideo : landscapeVideo;
      const inactiveVideo = isPortrait ? landscapeVideo : portraitVideo;

      // Remove the inactive video's source to prevent loading
      if (inactiveVideo) {
        const inactiveSource = inactiveVideo.querySelector('source');
        if (inactiveSource) {
          inactiveSource.removeAttribute('src');
        }
        inactiveVideo.load();
      }

      // Attempt to play the active video
      if (activeVideo) {
        const attemptPlay = () => {
          const playPromise = activeVideo.play();
          if (playPromise !== undefined) {
            playPromise.catch(() => {
              // Autoplay was prevented
            });
          }
        };

        activeVideo.addEventListener('canplay', attemptPlay);
        attemptPlay();
      }
    });
  </script>

  <style>
    .project-container {
      width: 100%;
      position: relative;
    }

    video {
      width: 100%;
      height: auto;
      display: block;
    }

    .landscape-video {
      display: block;
    }

    .portrait-video {
      display: none;
    }

    @media (max-width: 768px) and (orientation: portrait) {
      .landscape-video {
        display: none;
      }

      .portrait-video {
        display: block;
      }
    }
  </style>
</BaseLayout>
