---
import BaseLayout from '../layouts/BaseLayout.astro';
---
<BaseLayout title="Work | Ultratropic" activePage="work">
  <div class="projects-grid">
    <!-- Mackage Core -->
    <div class="project-item">
      <div class="media-wrapper">
        <video
          muted
          loop
          playsinline
          preload="none"
          class="landscape-video"
        >
          <source src="/projects/mackage-core/Mackage-Core-Thumb.mp4" type="video/mp4" />
        </video>
        <video
          muted
          loop
          playsinline
          preload="none"
          class="portrait-video"
        >
          <source src="/projects/mackage-core/Mackage-Core-Thumb-Portrait.mp4" type="video/mp4" />
        </video>
      </div>
      <div class="project-title">Mackage Core '25</div>
    </div>

    <!-- Steve Madden - SP24 -->
    <div class="project-item">
      <div class="media-wrapper">
        <video
          muted
          loop
          playsinline
          preload="none"
          class="landscape-video"
        >
          <source src="/projects/steve_madden-sp24/SM-S24-Thumb.mp4" type="video/mp4" />
        </video>
        <video
          muted
          loop
          playsinline
          preload="none"
          class="portrait-video"
        >
          <source src="/projects/steve_madden-sp24/SM-S24-Thumb-Portrait.mp4" type="video/mp4" />
        </video>
      </div>
      <div class="project-title">Steve Madden S24</div>
    </div>

    <!-- Woolrich -->
    <div class="project-item">
      <div class="media-wrapper">
        <video
          muted
          loop
          playsinline
          preload="none"
          class="landscape-video"
        >
          <source src="/projects/woolrich/WoolrichThumb.mp4" type="video/mp4" />
        </video>
        <video
          muted
          loop
          playsinline
          preload="none"
          class="portrait-video"
        >
          <source src="/projects/woolrich/WoolrichThumb-Portrait.mp4" type="video/mp4" />
        </video>
      </div>
      <div class="project-title">Woolrich</div>
    </div>

    <!-- Steve Madden - BTS -->
    <div class="project-item">
      <a href="/projects/steve-madden-bts" class="media-wrapper">
        <video
          muted
          loop
          playsinline
          preload="none"
        >
          <source src="/projects/steve_madden-bts/Madden-bts-thumb.mp4" type="video/mp4" />
        </video>
      </a>
      <div class="project-title">Steve Madden x Walmart</div>
    </div>

    <!-- Stone Island (photo) -->
    <div class="project-item">
      <div class="media-wrapper">
        <img src="/projects/stone_island/000086880009.jpg" alt="Stone Island" loading="lazy" />
      </div>
      <div class="project-title">Stone Island</div>
    </div>

    <!-- Merrell (photo) -->
    <div class="project-item">
      <div class="media-wrapper">
        <img src="/projects/merrell/000046660001.jpeg" alt="Merrell" loading="lazy" />
      </div>
      <div class="project-title">Merrell</div>
    </div>

    <!-- Steve Madden - Cool Planet -->
    <div class="project-item">
      <a href="/projects/steve-madden-cool-planet" class="media-wrapper">
        <video
          muted
          loop
          playsinline
          preload="none"
        >
          <source src="/projects/steve_madden-cool_planet/cool-planet-thumb.mp4" type="video/mp4" />
        </video>
      </a>
      <div class="project-title">Steve Madden Cool Planet</div>
    </div>

    <!-- Major Lazer -->
    <div class="project-item">
      <div class="media-wrapper">
        <video
          muted
          loop
          playsinline
          preload="none"
        >
          <source src="/projects/major_lazer/major-lazer-thumb.mp4" type="video/mp4" />
        </video>
      </div>
      <div class="project-title">Major Lazer</div>
    </div>

    <!-- Anitta -->
    <div class="project-item">
      <div class="media-wrapper">
        <video
          muted
          loop
          playsinline
          preload="none"
        >
          <source src="/projects/anitta/Aniita-Thumb.mp4" type="video/mp4" />
        </video>
      </div>
      <div class="project-title">Anitta</div>
    </div>

    <!-- Deerdana -->
    <div class="project-item">
      <div class="media-wrapper">
        <video
          muted
          loop
          playsinline
          preload="none"
        >
          <source src="/projects/deerdana/Deerdana-thumb.mp4" type="video/mp4" />
        </video>
      </div>
      <div class="project-title">Deerdana</div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const projectItems = document.querySelectorAll('.project-item');
      const isMobile = window.innerWidth <= 768;
      const isPortraitOrientation = window.matchMedia('(orientation: portrait)').matches;
      const shouldUsePortrait = isMobile && isPortraitOrientation;

      // Remove unused orientation videos
      projectItems.forEach(item => {
        const landscapeVideo = item.querySelector('.landscape-video');
        const portraitVideo = item.querySelector('.portrait-video');

        if (landscapeVideo && portraitVideo) {
          const videoToRemove = shouldUsePortrait ? landscapeVideo : portraitVideo;
          videoToRemove.remove();
        }
      });

      // Lazy-load and autoplay videos when they scroll into view
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          const video = entry.target;
          if (entry.isIntersecting) {
            video.preload = 'auto';
            video.play().catch(() => {});
          } else {
            video.pause();
          }
        });
      }, { rootMargin: '200px' });

      document.querySelectorAll('.media-wrapper video').forEach(video => {
        observer.observe(video);
      });
    });
  </script>

  <style>
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
    }

    .project-item {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .media-wrapper {
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;
      overflow: hidden;
      cursor: pointer;
      background: #000;
      display: block;
      text-decoration: none;
    }

    .media-wrapper video,
    .media-wrapper img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
      transform: scale(1.01);
    }

    .project-title {
      font-size: 0.875rem;
      color: #000;
      text-align: left;
    }

    @media (max-width: 768px) {
      .projects-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
    }
  </style>
</BaseLayout>
